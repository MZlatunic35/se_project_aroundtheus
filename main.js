!function(){"use strict";class e{constructor(e,t,s,r,o,i){let{name:n,link:l,isLiked:a,_id:d,userId:c,ownerId:u}=e;this._name=n,this._link=l,this._likes=a,this._id=d,this._userId=c,this._ownerId=u,this._myId=t,this._cardSelector=s,this._handleCardClick=r,this._handleDeleteClick=o,this._handleLikeClick=i}getId(){return this._id}_getData(){return{name:this._name,link:this._link}}setLikes(e){this._likes=e,this._renderLikes()}_renderLikes(){this._likes?this._cardElement.querySelector(".card__like-button").classList.add("card__like-button_active"):this._cardElement.querySelector(".card__like-button").classList.remove("card__like-button_active")}_hideDeleteButton(){this._ownerId!==this._userId&&this._cardElement.querySelector(".card__delete-button").remove()}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>this._handleLikeClick(this))),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleCardClick(this._getData())})),this._hideDeleteButton()}remove(){this._cardElement.remove()}_getTemplate(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardElement}_fillCardTemplate(){const e=this._cardElement.querySelector(".card__image");e.alt=`Photo of ${this._name}`,e.src=this._link,this._cardElement.id=this.imageId,this._cardElement.querySelector(".card__title").textContent=this._name}getView(){return this._cardElement=this._getTemplate(),this._fillCardTemplate(),this._setEventListeners(),this._renderLikes(),this._cardElement}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}resetValidation(){this._inputList.forEach((e=>{const t=this._formElement.querySelector(`#${e.id}-error`);this._hideInputError(e,t)})),this._toggleButtonState()}_toggleButtonState(){if(this._hasInvalidInput())return this._buttonElement.classList.add(this._inactiveButtonClass),void(this._buttonElement.disabled=!0);this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}_setEventListener(){this._inputList=[...this._formElement.querySelectorAll(this._inputSelector)],this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListener()}}class s{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__overlay")||e.target.classList.contains("modal__close"))&&this.close()}))}}class o extends r{constructor(e){let{popupSelector:t,handleFormSubmit:s,loadingButtonText:r}=e;super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=s,this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._submitButton=this._popupForm.querySelector(".modal__button"),this._buttonText=this._submitButton.textContent,this._loadingButtonText=r}_getInputValues(){return this._newData={},this._inputList.forEach((e=>{this._newData[e.name]=e.value})),this._newData}setEventListener(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){this._popupForm.reset(),super.close()}showLoading(){this._submitButton.textContent=this._loadingButtonText}hideLoading(){this._submitButton.textContent=this._buttonText}}const i=document.querySelector("#profile-edit-button"),n=document.querySelector("#profile-add-button"),l=document.querySelector("#profile-edit-modal"),a=document.querySelector("#add-card-modal"),d=document.querySelector("#preview-modal"),c=(l.querySelector(".modal__close"),a.querySelector(".modal__close"),d.querySelector(".modal__close"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#edit-form-title")),u=document.querySelector("#edit-form-description"),_=l.querySelector(".modal__form"),h=a.querySelector(".modal__form"),m=(document.querySelector(".cards__list"),document.querySelector("#card-template").content.firstElementChild,h.querySelector(".modal__input_type_title"),h.querySelector(".modal__input_type_url"),document.querySelector(".modal__preview-image"),document.querySelector(".modal__preview-footer"),document.querySelector("#delete-card-modal").querySelector(".modal__form"),{inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"});let p,S;const E=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch(`${this._url}/users/me`,{method:"GET",headers:this._headers}).then(this._processResponse)}getInitialCards(){return fetch(`${this._url}/cards`,{method:"GET",headers:this._headers}).then(this._processResponse)}editProfile(e){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._processResponse)}addNewCard(e){let{name:t,link:s}=e;return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})}).then(this._processResponse)}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._processResponse)}likeCard(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._processResponse)}unlikeCard(e){return fetch(`${this._url}/cards/${e}/likes/`,{method:"DELETE",headers:this._headers}).then(this._processResponse)}updateProfilePicture(e){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.link})}).then(this._processResponse)}_processResponse=e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a9aaf24d-57aa-44df-b0d5-364cf1f03985","Content-Type":"application/json"}}),f=new class{constructor(e){let{nameSelector:t,professionSelector:s,avatarSelector:r}=e;this._name=document.querySelector(t),this._about=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e){let{name:t,about:s,avatar:r}=e;this._name.textContent=t,this._about.textContent=s,r&&(this._avatarElement.src=r)}}({nameSelector:".profile__title",professionSelector:".profile__description",avatarSelector:".profile__image"});function v(e){e._likes?E.unlikeCard(e._id).then((t=>{e.setLikes(t.isLiked)})).catch(console.error):E.likeCard(e._id).then((t=>{e.setLikes(t.isLiked)})).catch(console.error)}function y(e){g.open(e)}Promise.all([E.getUserInfo(),E.getInitialCards()]).then((e=>{let[t,r]=e;f.setUserInfo(t),p=t._id,f.setUserInfo(t),S=new s({items:r,renderer:e=>{let{name:t,link:s,isLiked:r,_id:o,userId:i,ownerId:n}=e;const l=k({name:t,link:s,isLiked:r,_id:o,userId:i,ownerId:n});S.addItem(l)}},".cards__list"),S.renderItems()})).catch(console.error);const L=new class extends r{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button")}setSubmitAction(e){this._handleSubmit=e}setLoading(e,t){this._submitButton.textContent=e?"Deleting...":t}setEventListeners(){super.setEventListeners(),this._submitButton.addEventListener("click",(()=>{this._handleSubmit()}))}}("#delete-card-modal");function b(e){L.open(),L.setSubmitAction((()=>{L.setLoading(!0),E.deleteCard(e.getId()).then((()=>{e.remove(),L.close()})).catch(console.error).finally((()=>{L.setLoading(!1,"Yes")}))}))}function k(t){let{name:s,link:r,isLiked:o,_id:i,userId:n,ownerId:l}=t;return new e({name:s,link:r,isLiked:o,_id:i,userId:n,ownerId:l},p,"#card-template",y,b,v).getView()}L.setEventListeners();const g=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t})}open(e){let{link:t,name:s}=e;this._popupElement.querySelector(".modal__preview-footer").textContent=s;const r=this._popupElement.querySelector(".modal__preview-image");r.src=t,r.alt=s,super.open()}}({popupSelector:"#preview-modal",handleFormSubmit:function(e){let{name:t,about:s}=e;newUser.setUserInfo(t,s),C.close()}});g.setEventListeners();const C=new o({popupSelector:"#profile-edit-modal",handleFormSubmit:e=>{C.showLoading(),E.editProfile(e).then((()=>{f.setUserInfo(e),C.close()})).catch(console.error).finally((()=>{C.hideLoading()}))},loadingButtonText:"Saving..."});C.setEventListener(),i.addEventListener("click",(()=>{const e=f.getUserInfo();c.value=e.name,u.value=e.about,C.open()}));const q=new t(m,h);q.enableValidation();const I=new t(m,_),w=new t(m,document.querySelector("#edit-avatar-modal").querySelector(".modal__form"));I.enableValidation(),w.enableValidation();const B=new o({popupSelector:"#add-card-modal",handleFormSubmit:e=>{B.showLoading(),E.addNewCard(e).then((e=>{const t=k(e);S.prependItem(t),B.close()})).catch(console.error).finally((()=>{B.hideLoading()}))},loadingButtonText:"Saving..."});B.close(),B.setEventListener(),n.addEventListener("click",(()=>{q.resetValidation(),B.open()}));const x=document.querySelector(".profile__image-overlay"),T=(document.querySelector("#profile-avatar"),new o({popupSelector:"#edit-avatar-modal",handleFormSubmit:e=>{T.showLoading(),E.updateProfilePicture(e).then((e=>{f.setUserInfo(e),T.close()})).catch(console.error).finally((()=>{T.hideLoading()}))},loadingButtonText:"Saving..."}));T.close(),T.setEventListener(),x.addEventListener("click",(()=>{w.resetValidation(),T.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FGLEdBTUkyRSxFQUFzQixJQUFJbkssRUFDOUIwRixFQUpzQnJHLFNBQVNSLGNBQWMsc0JBQ1JBLGNBQWMsaUJBT3JEcUwsRUFBa0JoSSxtQkFDbEJpSSxFQUFvQmpJLG1CQVFwQixNQUFNa0ksRUFBZSxJQUFJTCxFQUFjLENBQ3JDNUcsY0FBZSxrQkFDZmEsaUJBQW1CMkMsSUFDakJ5RCxFQUFhckYsY0FDYmUsRUFDR2tCLFdBQVdMLEdBQ1hKLE1BQU1pRCxJQUNMLE1BQU1ULEVBQVVDLEVBQVdRLEdBQzNCM0QsRUFBUy9DLFlBQVlpRyxHQUNyQnFCLEVBQWE1RyxPQUFPLElBRXJCK0UsTUFBTUMsUUFBUUMsT0FDZGdCLFNBQVEsS0FDUFcsRUFBYXBGLGFBQWEsR0FDMUIsRUFFTmYsa0JBQW1CLGNBR3JCbUcsRUFBYTVHLFFBQ2I0RyxFQUFheEYsbUJBRWJNLEVBQWlCL0YsaUJBQWlCLFNBQVMsS0FDekM4SyxFQUFpQnpJLGtCQUNqQjRJLEVBQWE3RyxNQUFNLElBT3JCLE1BQU04RyxFQUFtQmhMLFNBQVNSLGNBQWMsMkJBRzFDeUwsR0FGZ0JqTCxTQUFTUixjQUFjLG1CQUVyQixJQUFJa0wsRUFBYyxDQUN4QzVHLGNBQWUscUJBQ2ZhLGlCQUFtQjJDLElBQ2pCMkQsRUFBZ0J2RixjQUNoQmUsRUFDR3VCLHFCQUFxQlYsR0FDckJKLE1BQU1nQixJQUNMTyxFQUFTTSxZQUFZYixHQUNyQitDLEVBQWdCOUcsT0FBTyxJQUV4QitFLE1BQU1DLFFBQVFDLE9BQ2RnQixTQUFRLEtBQ1BhLEVBQWdCdEYsYUFBYSxHQUM3QixFQUVOZixrQkFBbUIsZUFHckJxRyxFQUFnQjlHLFFBQ2hCOEcsRUFBZ0IxRixtQkFFaEJ5RixFQUFpQmxMLGlCQUFpQixTQUFTLEtBQ3pDZ0wsRUFBb0IzSSxrQkFDcEI4SSxFQUFnQi9HLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgeyBuYW1lLCBsaW5rLCBpc0xpa2VkLCBfaWQsIHVzZXJJZCwgb3duZXJJZCB9LFxuICAgIG15SWQsXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5fbGlrZXMgPSBpc0xpa2VkO1xuICAgIHRoaXMuX2lkID0gX2lkO1xuICAgIHRoaXMuX3VzZXJJZCA9IHVzZXJJZDtcbiAgICB0aGlzLl9vd25lcklkID0gb3duZXJJZDtcbiAgICB0aGlzLl9teUlkID0gbXlJZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG5cbiAgX2dldERhdGEoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUsXG4gICAgICBsaW5rOiB0aGlzLl9saW5rLFxuICAgIH07XG4gIH1cblxuICBzZXRMaWtlcyhpc0xpa2VkKSB7XG4gICAgdGhpcy5fbGlrZXMgPSBpc0xpa2VkO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKSB7XG4gICAgaWYgKHRoaXMuX2xpa2VzKSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxuICAgICAgICAuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgX2hpZGVEZWxldGVCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuX293bmVySWQgIT09IHRoaXMuX3VzZXJJZCkge1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCBsaWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICBsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcykpO1xuXG4gICAgY29uc3QgZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fZ2V0RGF0YSgpKTtcbiAgICB9KTtcbiAgICB0aGlzLl9oaWRlRGVsZXRlQnV0dG9uKCk7XG4gIH1cblxuICByZW1vdmUoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxuXG4gIF9maWxsQ2FyZFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgY2FyZEltYWdlLmFsdCA9IGBQaG90byBvZiAke3RoaXMuX25hbWV9YDtcbiAgICBjYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5pZCA9IHRoaXMuaW1hZ2VJZDtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2ZpbGxDYXJkVGVtcGxhdGUoKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IGNvbmZpZy5mb3JtU2VsZWN0b3I7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcblxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsLmlkfS1lcnJvcmBcbiAgICApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH1cbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBgIyR7aW5wdXRFbC5pZH0tZXJyb3JgXG4gICAgICApO1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCwgZXJyb3JNZXNzYWdlRWwpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0TGlzdC5ldmVyeSgoaW5wdXRFbCkgPT4gaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcigpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpLFxuICAgIF07XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dExpc3QpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXIoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNhcmRTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNhcmRTZWxlY3Rvcik7XG4gIH1cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIHByZXBlbmRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShlKSB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpIHx8XG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX292ZXJsYXlcIikgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGcm9tIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIGxvYWRpbmdCdXR0b25UZXh0IH0pIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5fYnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgICB0aGlzLl9sb2FkaW5nQnV0dG9uVGV4dCA9IGxvYWRpbmdCdXR0b25UZXh0O1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIHRoaXMuX25ld0RhdGEgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9uZXdEYXRhW2lucHV0RWxlbWVudC5uYW1lXSA9IGlucHV0RWxlbWVudC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5fbmV3RGF0YTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXIoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxuXG4gIHNob3dMb2FkaW5nKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2xvYWRpbmdCdXR0b25UZXh0O1xuICB9XG5cbiAgaGlkZUxvYWRpbmcoKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fYnV0dG9uVGV4dDtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVNb2RhbENsb3NlQnV0dG9uID1cbiAgcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kYWxDbG9zZUJ1dHRvbiA9XG4gIGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3TW9kYWxDbG9zZUJ1dHRvbiA9XG4gIHByZXZpZXdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxuKTtcbmV4cG9ydCBjb25zdCBtb2RhbFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtZm9ybS10aXRsZVwiKTtcbmV4cG9ydCBjb25zdCBtb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNlZGl0LWZvcm0tZGVzY3JpcHRpb25cIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEZvcm0gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGUgPVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcbmV4cG9ydCBjb25zdCBjYXJkVGl0bGVJbnB1dCA9IGFkZENhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19pbnB1dF90eXBlX3RpdGxlXCJcbik7XG5leHBvcnQgY29uc3QgY2FyZFVybElucHV0ID0gYWRkQ2FyZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW5wdXRfdHlwZV91cmxcIik7XG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcbmV4cG9ydCBjb25zdCBwcmV2aWV3Rm9vdGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1mb290ZXJcIik7XG5jb25zdCBkZWxldGVDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmRGb3JtID0gZGVsZXRlQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbmV4cG9ydCBjb25zdCBmb3JtVmFsaWRhdGlvbkNvbmZpZyA9IHtcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcbmltcG9ydCB7XG4gIC8vIGluaXRpYWxDYXJkcyxcbiAgcHJvZmlsZUVkaXRCdXR0b24sXG4gIHByb2ZpbGVBZGRCdXR0b24sXG4gIHByb2ZpbGVFZGl0TW9kYWwsXG4gIGFkZENhcmRNb2RhbCxcbiAgcHJldmlld0ltYWdlTW9kYWwsXG4gIHByb2ZpbGVNb2RhbENsb3NlQnV0dG9uLFxuICBhZGRDYXJkTW9kYWxDbG9zZUJ1dHRvbixcbiAgcHJldmlld01vZGFsQ2xvc2VCdXR0b24sXG4gIHByb2ZpbGVUaXRsZSxcbiAgcHJvZmlsZURlc2NyaXB0aW9uLFxuICBtb2RhbFRpdGxlSW5wdXQsXG4gIG1vZGFsRGVzY3JpcHRpb25JbnB1dCxcbiAgcHJvZmlsZUVkaXRGb3JtLFxuICBhZGRDYXJkRm9ybSxcbiAgY2FyZExpc3RFbCxcbiAgY2FyZFRlbXBsYXRlLFxuICBjYXJkVGl0bGVJbnB1dCxcbiAgY2FyZFVybElucHV0LFxuICBwcmV2aWV3SW1hZ2UsXG4gIHByZXZpZXdGb290ZXIsXG4gIGZvcm1WYWxpZGF0aW9uQ29uZmlnLFxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFQSSArIHVzZXJJbmZvXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5sZXQgdXNlcklEO1xubGV0IGNhcmRMaXN0O1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJhOWFhZjI0ZC01N2FhLTQ0ZGYtYjBkNS0zNjRjZjFmMDM5ODVcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgcHJvZmVzc2lvblNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcbn0pO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbdXNlciwgaW5pdGlhbENhcmRzXSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXIpO1xuICAgIHVzZXJJRCA9IHVzZXIuX2lkO1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXIpO1xuXG4gICAgY2FyZExpc3QgPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICAgICAgcmVuZGVyZXI6ICh7IG5hbWUsIGxpbmssIGlzTGlrZWQsIF9pZCwgdXNlcklkLCBvd25lcklkIH0pID0+IHtcbiAgICAgICAgICBjb25zdCBuZXdDYXJkID0gY3JlYXRlQ2FyZCh7XG4gICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgbGluayxcbiAgICAgICAgICAgIGlzTGlrZWQsXG4gICAgICAgICAgICBfaWQsXG4gICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICBvd25lcklkLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNhcmRMaXN0LmFkZEl0ZW0obmV3Q2FyZCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgXCIuY2FyZHNfX2xpc3RcIlxuICAgICk7XG4gICAgY2FyZExpc3QucmVuZGVySXRlbXMoKTtcbiAgfSlcbiAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gSGFuZGxlIENsaWNrc1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmRJbnN0YW5jZSkge1xuICBpZiAoY2FyZEluc3RhbmNlLl9saWtlcykge1xuICAgIGFwaVxuICAgICAgLnVubGlrZUNhcmQoY2FyZEluc3RhbmNlLl9pZClcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY2FyZEluc3RhbmNlLnNldExpa2VzKHJlcy5pc0xpa2VkKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gIH0gZWxzZSB7XG4gICAgYXBpXG4gICAgICAubGlrZUNhcmQoY2FyZEluc3RhbmNlLl9pZClcbiAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgY2FyZEluc3RhbmNlLnNldExpa2VzKHJlcy5pc0xpa2VkKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGRhdGEpIHtcbiAgcHJldmlld0ltYWdlUG9wdXAub3BlbihkYXRhKTtcbn1cblxuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSB7XG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCk7XG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgIGRlbGV0ZUNhcmRQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xuICAgIGFwaVxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5nZXRJZCgpKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjYXJkLnJlbW92ZSgpO1xuICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLnNldExvYWRpbmcoZmFsc2UsIFwiWWVzXCIpO1xuICAgICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKHsgbmFtZSwgbGluaywgaXNMaWtlZCwgX2lkLCB1c2VySWQsIG93bmVySWQgfSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxuICAgIHsgbmFtZSwgbGluaywgaXNMaWtlZCwgX2lkLCB1c2VySWQsIG93bmVySWQgfSxcbiAgICB1c2VySUQsXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50LmdldFZpZXcoKTtcbn1cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQcmV2aWV3IFBvcHVwXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCBwcmV2aWV3SW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiI3ByZXZpZXctbW9kYWxcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQsXG59KTtcbnByZXZpZXdJbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQcm9maWxlIFBvcHVwXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdCh7IG5hbWUsIGFib3V0IH0pIHtcbiAgbmV3VXNlci5zZXRVc2VySW5mbyhuYW1lLCBhYm91dCk7XG4gIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xufVxuXG5jb25zdCBwcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxuICBoYW5kbGVGb3JtU3VibWl0OiAoaW5wdXRWYWx1ZXMpID0+IHtcbiAgICBwcm9maWxlUG9wdXAuc2hvd0xvYWRpbmcoKTtcbiAgICBhcGlcbiAgICAgIC5lZGl0UHJvZmlsZShpbnB1dFZhbHVlcylcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMpO1xuICAgICAgICBwcm9maWxlUG9wdXAuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgcHJvZmlsZVBvcHVwLmhpZGVMb2FkaW5nKCk7XG4gICAgICB9KTtcbiAgfSxcbiAgbG9hZGluZ0J1dHRvblRleHQ6IFwiU2F2aW5nLi4uXCIsXG59KTtcblxucHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXIoKTtcblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBtb2RhbFRpdGxlSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5uYW1lO1xuICBtb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5hYm91dDtcbiAgcHJvZmlsZVBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVmFsaWRhdGlvblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1WYWxpZGF0aW9uQ29uZmlnLCBhZGRDYXJkRm9ybSk7XG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgZm9ybVZhbGlkYXRpb25Db25maWcsXG4gIHByb2ZpbGVFZGl0Rm9ybVxuKTtcblxuY29uc3QgYXZhdGFyRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LWF2YXRhci1tb2RhbFwiKTtcbmNvbnN0IGF2YXRhckVkaXRGb3JtID0gYXZhdGFyRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbmNvbnN0IGVkaXRBdmF0YXJWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgZm9ybVZhbGlkYXRpb25Db25maWcsXG4gIGF2YXRhckVkaXRGb3JtXG4pO1xuXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5lZGl0QXZhdGFyVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuZXhwb3J0IHsgcHJldmlld0ltYWdlLCBwcmV2aWV3Rm9vdGVyLCBwcmV2aWV3SW1hZ2VNb2RhbCB9O1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQWRkIENhcmQgUG9wdXBcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjYWRkLWNhcmQtbW9kYWxcIixcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGlucHV0VmFsdWVzKSA9PiB7XG4gICAgYWRkQ2FyZFBvcHVwLnNob3dMb2FkaW5nKCk7XG4gICAgYXBpXG4gICAgICAuYWRkTmV3Q2FyZChpbnB1dFZhbHVlcylcbiAgICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICAgIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKGNhcmQpO1xuICAgICAgICBjYXJkTGlzdC5wcmVwZW5kSXRlbShuZXdDYXJkKTtcbiAgICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGFkZENhcmRQb3B1cC5oaWRlTG9hZGluZygpO1xuICAgICAgfSk7XG4gIH0sXG4gIGxvYWRpbmdCdXR0b25UZXh0OiBcIlNhdmluZy4uLlwiLFxufSk7XG5cbmFkZENhcmRQb3B1cC5jbG9zZSgpO1xuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXIoKTtcblxucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBhZGRDYXJkUG9wdXAub3BlbigpO1xufSk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBQcm9maWxlIEF2YXRhclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2Utb3ZlcmxheVwiKTtcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYXZhdGFyXCIpO1xuXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiI2VkaXQtYXZhdGFyLW1vZGFsXCIsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dFZhbHVlcykgPT4ge1xuICAgIGVkaXRBdmF0YXJQb3B1cC5zaG93TG9hZGluZygpO1xuICAgIGFwaVxuICAgICAgLnVwZGF0ZVByb2ZpbGVQaWN0dXJlKGlucHV0VmFsdWVzKVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xuICAgICAgICBlZGl0QXZhdGFyUG9wdXAuY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgZWRpdEF2YXRhclBvcHVwLmhpZGVMb2FkaW5nKCk7XG4gICAgICB9KTtcbiAgfSxcbiAgbG9hZGluZ0J1dHRvblRleHQ6IFwiU2F2aW5nLi4uXCIsXG59KTtcblxuZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcigpO1xuXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRBdmF0YXJWYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGVkaXRBdmF0YXJQb3B1cC5vcGVuKCk7XG59KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGVkaXRQcm9maWxlKGlucHV0VmFsdWVzKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsXG4gICAgICAgIGFib3V0OiBpbnB1dFZhbHVlcy5hYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzUmVzcG9uc2UpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSUQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJRH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fcHJvY2Vzc1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElEfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzUmVzcG9uc2UpO1xuICB9XG5cbiAgdW5saWtlQ2FyZChjYXJkSUQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXMvYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX3Byb2Nlc3NSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVQcm9maWxlUGljdHVyZShpbnB1dFZhbHVlcykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBpbnB1dFZhbHVlcy5saW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9wcm9jZXNzUmVzcG9uc2UpO1xuICB9XG5cbiAgX3Byb2Nlc3NSZXNwb25zZSA9IChyZXMpID0+IHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9O1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgcHJvZmVzc2lvblNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmVzc2lvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWUudGV4dENvbnRlbnQsXG4gICAgICBhYm91dDogdGhpcy5fYWJvdXQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIGF2YXRhciB9KSB7XG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgICBpZiAoYXZhdGFyKSB7XG4gICAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgfVxuXG4gIHNldFN1Ym1pdEFjdGlvbihjYWxsQmFjaykge1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGNhbGxCYWNrO1xuICB9XG5cbiAgc2V0TG9hZGluZyhpc0xvYWRpbmcsIG9yaWdpbmFsVGV4dCkge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0O1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgfVxuXG4gIG9wZW4oeyBsaW5rLCBuYW1lIH0pIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1mb290ZXJcIikudGV4dENvbnRlbnQgPVxuICAgICAgbmFtZTtcbiAgICBjb25zdCBpbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCIpO1xuICAgIGltYWdlLnNyYyA9IGxpbms7XG4gICAgaW1hZ2UuYWx0ID0gbmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwibXlJZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwibmFtZSIsImxpbmsiLCJpc0xpa2VkIiwiX2lkIiwidXNlcklkIiwib3duZXJJZCIsInRoaXMiLCJfbmFtZSIsIl9saW5rIiwiX2xpa2VzIiwiX3VzZXJJZCIsIl9vd25lcklkIiwiX215SWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJnZXRJZCIsIl9nZXREYXRhIiwic2V0TGlrZXMiLCJfcmVuZGVyTGlrZXMiLCJfY2FyZEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiX2hpZGVEZWxldGVCdXR0b24iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2ZpbGxDYXJkVGVtcGxhdGUiLCJjYXJkSW1hZ2UiLCJhbHQiLCJzcmMiLCJpZCIsImltYWdlSWQiLCJ0ZXh0Q29udGVudCIsImdldFZpZXciLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInJlc2V0VmFsaWRhdGlvbiIsIl9pbnB1dExpc3QiLCJmb3JFYWNoIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9idXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJldmVyeSIsIl9zZXRFdmVudExpc3RlbmVyIiwicXVlcnlTZWxlY3RvckFsbCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiZWxlbWVudCIsImFwcGVuZCIsInByZXBlbmRJdGVtIiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiaXRlbSIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwiZXZ0IiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGcm9tIiwiaGFuZGxlRm9ybVN1Ym1pdCIsImxvYWRpbmdCdXR0b25UZXh0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfc3VibWl0QnV0dG9uIiwiX2J1dHRvblRleHQiLCJfbG9hZGluZ0J1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfbmV3RGF0YSIsImlucHV0RWxlbWVudCIsInZhbHVlIiwic2V0RXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicmVzZXQiLCJzaG93TG9hZGluZyIsImhpZGVMb2FkaW5nIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlQWRkQnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsImFkZENhcmRNb2RhbCIsInByZXZpZXdJbWFnZU1vZGFsIiwibW9kYWxUaXRsZUlucHV0IiwibW9kYWxEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUVkaXRGb3JtIiwiYWRkQ2FyZEZvcm0iLCJmb3JtVmFsaWRhdGlvbkNvbmZpZyIsImZpcnN0RWxlbWVudENoaWxkIiwidXNlcklEIiwiY2FyZExpc3QiLCJhcGkiLCJvcHRpb25zIiwiX3VybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwibWV0aG9kIiwidGhlbiIsIl9wcm9jZXNzUmVzcG9uc2UiLCJnZXRJbml0aWFsQ2FyZHMiLCJlZGl0UHJvZmlsZSIsImlucHV0VmFsdWVzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImFkZE5ld0NhcmQiLCJkZWxldGVDYXJkIiwiY2FyZElEIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwidXBkYXRlUHJvZmlsZVBpY3R1cmUiLCJhdmF0YXIiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwicHJvZmVzc2lvblNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfYWJvdXQiLCJfYXZhdGFyRWxlbWVudCIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJjYXJkSW5zdGFuY2UiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImRhdGEiLCJwcmV2aWV3SW1hZ2VQb3B1cCIsImFsbCIsInVzZXIiLCJpbml0aWFsQ2FyZHMiLCJuZXdDYXJkIiwiY3JlYXRlQ2FyZCIsImRlbGV0ZUNhcmRQb3B1cCIsInNldFN1Ym1pdEFjdGlvbiIsImNhbGxCYWNrIiwiX2hhbmRsZVN1Ym1pdCIsInNldExvYWRpbmciLCJpc0xvYWRpbmciLCJvcmlnaW5hbFRleHQiLCJjYXJkIiwiZmluYWxseSIsIl9yZWYzIiwiaW1hZ2UiLCJfcmVmNCIsIm5ld1VzZXIiLCJwcm9maWxlUG9wdXAiLCJQb3B1cFdpdGhGb3JtIiwidXNlckRhdGEiLCJhZGRGb3JtVmFsaWRhdG9yIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJlZGl0QXZhdGFyVmFsaWRhdG9yIiwiYWRkQ2FyZFBvcHVwIiwiYXZhdGFyRWRpdEJ1dHRvbiIsImVkaXRBdmF0YXJQb3B1cCJdLCJzb3VyY2VSb290IjoiIn0=